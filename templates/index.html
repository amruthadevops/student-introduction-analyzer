<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Introduction Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .score-card { 
            background: #f8f9fa; 
            border-radius: 10px; 
            padding: 15px; 
            margin: 10px 0; 
            border-left: 4px solid #007bff;
        }
        .criteria-score { 
            font-weight: bold; 
            color: #007bff; 
            font-size: 1.2em;
        }
        .overall-score {
            font-size: 2.5em;
            font-weight: bold;
            color: #28a745;
        }
        .feedback-item {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #dee2e6;
        }
    </style>
</head>
<body class="p-4" style="background-color: #f5f5f5;">
    <div class="container">
        <!-- Header -->
        <div class="text-center mb-4">
            <h1 class="display-4">üéØ Student Introduction Analyzer</h1>
            <p class="lead">AI-powered assessment of student self-introductions</p>
        </div>
        
        <!-- Input Card -->
        <div class="card shadow-lg mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">üìù Paste Student's Self-Introduction</h5>
            </div>
            <div class="card-body">
                <textarea id="transcript" class="form-control" rows="8" 
                    placeholder="Enter the transcript here...">Hello everyone, myself Muskan, studying in class 8th B section from Christ Public School. I am 13 years old. I live with my family. There are 3 people in my family, me, my mother and my father. One special thing about my family is that they are very kind hearted to everyone and soft spoken. One thing I really enjoy is play, playing cricket and taking wickets. A fun fact about me is that I see in mirror and talk by myself. One thing people don't know about me is that I once stole a toy from one of my cousin. My favorite subject is science because it is very interesting. Through science I can explore the whole world and make the discoveries and improve the lives of others. Thank you for listening.</textarea>
                <button id="analyzeBtn" class="btn btn-success btn-lg mt-3 w-100">
                    üöÄ Analyze Introduction
                </button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="result" class="card shadow-lg" style="display: none;">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0">üìä Analysis Results</h4>
            </div>
            <div class="card-body">
                <!-- Overall Score -->
                <div class="text-center mb-4 p-4 bg-light rounded">
                    <h3>Overall Score</h3>
                    <div class="overall-score" id="overallScore">0</div>
                    <small class="text-muted">out of 100 points</small>
                </div>
                
                <!-- Criteria Breakdown -->
                <h5>üìà Criteria Breakdown</h5>
                <div id="criteriaScores" class="row"></div>
                
                <!-- Detailed Feedback -->
                <h5 class="mt-4">üí° Detailed Feedback</h5>
                <div id="feedback" class="score-card"></div>
                
                <!-- Word Count -->
                <div class="mt-3 text-end">
                    <small class="text-muted">üìù Word Count: <span id="wordCount">0</span> words</small>
                </div>
            </div>
        </div>
    
    </div>

    <script>
        document.getElementById('analyzeBtn').onclick = async () => {
            const text = document.getElementById('transcript').value;
            
            if (!text.trim()) {
                alert('‚ùå Please enter some text to analyze');
                return;
            }

            // Show loading state
            const btn = document.getElementById('analyzeBtn');
            btn.innerHTML = '‚è≥ Analyzing...';
            btn.disabled = true;

            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({text: text})
                });

                const result = await response.json();
                
                if (result.error) {
                    alert('‚ùå Error: ' + result.error);
                    return;
                }

                // Display overall score
                document.getElementById('overallScore').textContent = result.overall_score;
                
                // Display criteria scores
                let criteriaHTML = '';
                const maxScores = {
                    'content_structure': 40,
                    'speech_rate': 10, 
                    'language_grammar': 20,
                    'clarity': 15,
                    'engagement': 15
                };

                for (const [criterion, score] of Object.entries(result.criteria_scores)) {
                    const maxScore = maxScores[criterion] || 100;
                    const percentage = (score / maxScore) * 100;
                    const progressColor = percentage >= 80 ? 'bg-success' : 
                                         percentage >= 60 ? 'bg-warning' : 'bg-danger';
                    
                    criteriaHTML += `
                        <div class="col-md-6 mb-3">
                            <div class="score-card">
                                <strong>${criterion.replace('_', ' ').toUpperCase()}</strong>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="criteria-score">${score}/${maxScore}</span>
                                    <small>${percentage.toFixed(0)}%</small>
                                </div>
                                <div class="progress mt-2" style="height: 8px;">
                                    <div class="progress-bar ${progressColor}" 
                                         style="width: ${percentage}%"></div>
                                </div>
                            </div>
                        </div>`;
                }
                document.getElementById('criteriaScores').innerHTML = criteriaHTML;
                
                // Display feedback
                let feedbackHTML = '';
                for (const [aspect, feedback] of Object.entries(result.detailed_feedback)) {
                    feedbackHTML += `
                        <div class="feedback-item">
                            <strong>${aspect.replace('_', ' ').toUpperCase()}:</strong><br>
                            ${feedback}
                        </div>`;
                }
                document.getElementById('feedback').innerHTML = feedbackHTML;
                
                // Display word count
                document.getElementById('wordCount').textContent = result.word_count;
                
                // Show results
                document.getElementById('result').style.display = 'block';
                
                // Scroll to results
                document.getElementById('result').scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                alert('‚ùå Error analyzing text: ' + error.message);
            } finally {
                // Reset button
                btn.innerHTML = 'üöÄ Analyze Introduction';
                btn.disabled = false;
            }
        };

        // Auto-analyze sample text on page load
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.getElementById('analyzeBtn').click();
            }, 1000);
        });
    </script>
</body>
</html>